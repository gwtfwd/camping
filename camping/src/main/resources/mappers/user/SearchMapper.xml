<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="kr.green.camping.dao.user.SearchMapper">
	
	<!-- camp -->
	<select id="getCampByNo" resultType="kr.green.camping.vo.user.CampVO">
		select * from camp where no = #{no}
	</select>

	
	<!-- 좋아요 -->
	 	<insert id="insertBoardLike">
            INSERT INTO liketo (camp_no, user_id)
            VALUES (#{camp_no}, #{user_id})
        </insert>

        <delete id="deleteBoardLike">
            DELETE FROM liketo
            WHERE camp_no = #{camp_no} AND user_id = #{user_id}
        </delete>

        <select id="updateBoardLike">
            UPDATE camp
            SET
            like_cnt = (SELECT COUNT(*)
            FROM liketo
            WHERE camp_no = #{camp_no})
            WHERE no = #{camp_no}
        </select>

        <select id="getBoardLike" resultType="int">
            SELECT COUNT(like_no) FROM liketo WHERE camp_no = #{camp_no} AND user_id = #{user_id}
        </select>	
	
	
	
	
	<!-- region -->
	<select id="getSeoul" resultType="kr.green.camping.vo.user.CampVO">
		select camp_name from camp where address_jibun like "%서울%" or address_road like "%서울%"; 
	</select>
	
	
	
	<!-- type -->
	<select id="getTypeByNo" resultType="kr.green.camping.vo.user.CampVO">
		select * from camp where no = #{no}
	</select>
	
	
	
	
	
	<!-- 검색 -->
	<select id="getType" resultType="kr.green.camping.vo.user.CampVO">
		select no, 
			camp_type_no, 
			camp_name, 
			address_road,
			address_jibun,
			camp_tel,
			latitude,
			longitude,
			area,
			man_agency_tel,
			man_agency_name,
			registered_id,
			registered_at,
			like_cnt
		from camp
		where 1 = 1 
			<if test="type==1">
				 and camp_type_no = 'P0001'
			</if>
			<if test="type==2">
				 and camp_type_no = 'P0003'
			</if>
			<if test="type==3">
				 and camp_type_no = 'P0002'
			</if>
		order by camp_name asc
		limit
			#{cri.pageStart},#{cri.perPageNum}
	</select>
	
	<select id="getCountType" resultType="java.lang.Integer">
		select
			count(no)
		from
			camp
		where 1=1
			<if test="type==1">
				 and camp_type_no = 'P0001'
			</if>
			<if test="type==2">
				 and camp_type_no = 'P0003'
			</if>
			<if test="type==3">
				 and camp_type_no = 'P0002'
			</if>
	</select>
	
	
</mapper>